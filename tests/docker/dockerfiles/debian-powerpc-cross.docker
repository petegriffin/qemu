#
# Docker powerpc cross-compiler target
#
# This docker target builds on the base debian image.
#
FROM qemu:debian
MAINTAINER Philippe Mathieu-Daud√© <f4bug@amsat.org>

# Add the foreign architecture we want and install dependencies
RUN dpkg --add-architecture powerpc && \
    apt-get update && \
    DEBIAN_FRONTEND=noninteractive eatmydata apt-get install -y --no-install-recommends \
        crossbuild-essential-powerpc

# Specify the cross prefix for this image (see tests/docker/common.rc)
ENV QEMU_CONFIGURE_OPTS --cross-prefix=powerpc-linux-gnu-

RUN DEBIAN_FRONTEND=noninteractive eatmydata apt-get build-dep -yy -a powerpc qemu && \
    DEBIAN_FRONTEND=noninteractive apt-get install -y --no-install-recommends \
        glusterfs-common:powerpc \
        libncursesw5-dev:powerpc libnfs-dev:powerpc \
        libbz2-dev:powerpc liblzo2-dev:powerpc \
        libsnappy-dev:powerpc librdmacm-dev:powerpc
